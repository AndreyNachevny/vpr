# Лаба №5. Настройка сетевых экранов и технологии отображения портов (в процессе)
## Файлы к лабе

- Порядок выполнения [(.pdf)](./Metodichka_LR5.pdf)

## Нам понадобится
- ВМ 1 (Спамер или еще кто-то из плохих людей)
- ВМ 2 (Фаервол; Он же - щит, который будет отбивать атаки ВМ 1)
- ВМ 3 (потенциальный сервер)

## Описание
![изображение](https://user-images.githubusercontent.com/76239707/165601000-5d022fb9-6b74-4909-9dd2-1698c3bb207a.png)

Нам требуется построить такую систему, при которой...

#### Что такое iptables?
iptables является утилитой, выполняющей функции межсетевого экрана. Настройка iptables производится в командной строке, с помощью правил iptables можно разрешать или блокировать прохождение трафика. Когда происходит попытка установления соединения с текущей машиной, iptables просматривает список правил в списке, чтобы понять, как нужно поступить в этом случае. Если правила нет, то выполняется действие по умолчанию.

Как правило, itpables предустанавливается на всех Linux-дистрибутивах.

#### Типы правил 

Существует три типа правил iptables — input, **forward** и output.

###### Input — Такие цепочки используются для контроля поведения входящих соединений. К примеру, если пользователь попробует подключиться к серверу по SSH, то iptables сравнит его IP-адрес со своим списком, чтобы разрешить или запретить доступ.

**Forward** — Правила этого типа используются для обработки входящих сообщений, конечный пункт назначения которых не является текущим сервером. К примеру, в случае маршрутизатора, к нему подключаются многие пользователи и приложения, но данные не посылаются на сам маршрутизатор, они лишь передаются ему, чтобы он мог перенаправить их адресату. Если вы не занимаетесь настройкой маршрутизации или NAT, то правила этого типа использовать в работе не будете.

###### Output — Такие цепочки используются для исходящих соединений. К прмиеру, если пользователь пытается отправинг запрос ping к сайту google.com, iptables изучит цепочку правил, чтобы понять, что нужно делать в случае ping и этого сайт, и только потом разрешит или запретит соединение.

## Начало

### Установка ВМ

Надеюсь, что за 4 лабы вы научились устанавливать ВМ (виртуальные машины) и не нуждаетесь в Божьей помощи, если это не так, то рекомендую посмотреть начало 3й лабы

#### Из особенностей установки стоит отметить:
Установка аналогично лабе 2 (маршрутизатор)

Т.е. нам нужны 3 машины, 2 из которых с разлиными сетевыми адаптерами, а 3тья должна иметь 2 адаптера, пример:
- ВМ1 Имеет только сетевой адаптер: "Сетевой мост"
- ВМ2 Имеет 2 сетевых адаптера: "Сетевой мост" и "Виртуальный хост адаптера"
- ВМ3 Имеет только сетевой адаптер: "Виртуальный хост адаптера"

### Установка статического IP для всех 3х машин

аналогично: в 3й лабе понятно описано то, как это делать [netplan выдача статического ip](https://github.com/xarll/vpr12/blob/main/seti/lab3/lab3.md#%D1%81%D0%B1%D0%BE%D1%80-%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D0%B8-%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-%D1%81%D1%82%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D1%85-ip)

Нам следует для всех 3х машин зафиксировать ip, чтобы не испытывать проблем с этим в будущем, хотя этот пункт необязательный.<br/>
В моем случае после манипуляций я имею:
|№|Интерфейс|ВМ 1|ВМ 2|ВМ 3|
|---|---|---|---|---|
|1|enp0s3|`192.168.0.110`|`192.168.0.111`|`192.168.0.112`|
|2|enp0s8|`-`|`192.168.56.110`|`-`|

